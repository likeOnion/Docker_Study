1. 도커 네트워크 동작 방식

    리눅스는 ifconfig, 윈도우는 ipconfig로 ip 주소 확인 가능

    기본적으로 컨테이너에서 ifconfig 입력 시 lo와 eth0 두 가지 네트워크가 조회됨

        -참고로 eth0의 IP는 실행 시 마다 변경 됨

    컨테이너의 eth0들은 호스트의 veth로 연결되고, veth는 docekr0 브리지와 바인딩, docker0는 호스트의 eth0과 바인딩 됨

        - brctrl show docker0 명령어로 바인딩 확인 가능

2. 도커 네트워크 생성

    네트워크 생성 후 docker run 할 때 --net (네트워크 이름) 으로 네트워크 연결 가능
    
    docker network connect/disconnect (네트워크 이름) (컨테이너 이름) 으로 네트워크 연결 및 해제 가능

    --net-alias 옵션 : 특정 호스트 이름으로 여러 개의 컨테이너에 접속할 수 있게 하는 옵션

        -ex) docker run -i -t --name alias_container --net mybrige --net-alias ijh4565 ubuntu:14.04

     핑 전송 시 같은 alias라도 매번 다른 IP 주소를 보내는데 이는 도커가 라운드 로빌 방식으로 네트워크를 할당하기 때문

        -라운드 로빌 : 하나의 중앙처리장치를 여러 프로세스들이 우선순위 없이 돌아가며 할당 받아 실행되는 방식
        
     도커는 사용자가 정의한 브리지 네트워크를 사용하는데 호스트의 IP는 DNS 서버에 저장되서 호스트 이름으로 접근 시 라운드 로빌 방식으로 컨테이너 IP리스트를 반환함

        이는 여러 번 반복해서 설명하지만 컨테이너의 IP가 실행할 때 마다 바뀌기 때문에 도커는 컨테이너를 IP가 아닌 이름으로 식별함, 따라서 호스트가 net alias로 여러 컨테이너에 동시에 접속해서 명령을 전송할 경우, IP로 컨테이너를 추적하는 것보다 컨테이너 이름으로 추적하는 게 더 효율적이기 때문에 net alias로 접속한 호스트의 이름도 컨테이너의 이름과 마찬가지로 도커의 DNS 서버에 저장함 : 이는 쿠버네티스의 동작 방식과 동일하다!

     어렵게 설명했지만 쉽게 말해 도커는 컨테이너를 IP가 아니라 이름으로 식별한다는 정도만 기억하면 됨

    브리지

        기본 네트워크

        - docker network create --drive bridge (브리지 이름)으로 생성 가능


    host

        - docker run -i -t --net host ~~~~ 으로 생성 시 호스트와 동일한 네트워크를 사용함 : 별도의 포트 포워딩/바인딩 없이 서비스 가능

    none

        네트워크 연결 안함, none으로 생성 후 ifconifg 하면 lo만 조회됨

    컨테이너 네트워크
    
        --net container:(컨테이너 이름)  : 입력한 컨테이너와 동일한 네트워크 네임스페이스를 공유함

    
    책에는 MacVLAN 생성도 있는데 이건 도저히 무슨 말인지 이해가 안됨


